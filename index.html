<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KBM English LDR - E-Learning</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <header>
      <h1>ðŸ“š KBM English LDR - E-Learning System</h1>
    </header>

    <div class="container">
      <aside class="sidebar">
        <h2>ðŸ“… Jadwal Belajar</h2>
        <ul>
          <li onclick="loadModule('week1')">Week 1 â€“ Basic English</li>
          <li onclick="loadModule('week2')">Week 2 â€“ Coming soon</li>
          <li onclick="loadModule('week3')">Week 3 â€“ Coming Soon</li>
          <li onclick="loadModule('week4')">Week 4 â€“ Coming Soon</li>
        </ul>
      </aside>

      <main class="content">
        <h2 id="module-title">Pilih Minggu untuk Memulai</h2>
        <div id="module-content">Silakan pilih minggu belajar dari menu kiri.</div>
      </main>
    </div>

    <!-- Firebase + app.js digabung dalam satu module -->
    <script type="module">
      // ----------------------
      // Firebase Initialization
      // ----------------------
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js';
      import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from 'https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js';
      import { getFirestore, doc, setDoc } from 'https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js';

      const firebaseConfig = {
        apiKey: 'AIzaSyARsav9m6Xv9H-XPPKnX8DNFwhZesRxQqE',
        authDomain: 'elearning-english.firebaseapp.com',
        projectId: 'elearning-english',
        storageBucket: 'elearning-english.appspot.com',
        messagingSenderId: '307108036106',
        appId: '1:307108036106:web:5c8a2b0bbdc7a084f7e9f3',
        measurementId: 'G-PMDQYNRNP9',
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      // ----------------------
      // Export ke global
      // ----------------------
      window.auth = auth;
      window.db = db;

      // ----------------------
      // Modules & Functions
      // ----------------------
      const modules = {
        week1: {
          title: 'Week 1 â€“ Basic Survival English',
          content: `
<div class='module-box'><h3>Materi</h3>
<ul>
<li>Pronouns (I, You, He/She...)</li>
<li>Simple Present</li>
<li>Past Tense</li>
<li>Daily Vocabulary</li>
</ul></div>

<div class='module-box'><h3>Jadwal KBM (30 min per day)</h3>
<p><b>Day 1:</b> Pronouns</p>

<p>
  <strong>Link Meeting:</strong><br>
  <a href="https://meet.google.com/gwh-auyb-wyq" target="_blank">
    https://meet.google.com/gwh-auyb-wyq
  </a>
</p>

<div class="pdf-box">
  <h4>ðŸ“„ Modul Day 1 (PDF)</h4>
  <div class="pdf-small-preview">
    <iframe src="Pronouns.pdf" width="180px" height="140px" style="border:1px solid #ccc; border-radius:8px;"></iframe>
  </div>
  <a href="Pronouns.pdf" download class="pdf-download">â¬‡ Download PDF</a>
</div>

<div class="module-box">
  <h3>ðŸŽ§ Latihan Listening â€“ Subject & Object Pronouns (10 Soal)</h3>
  <p>Pilih jawaban yang benar berdasarkan kalimat yang didengar (mentor membacakan soal).</p>
  <ol id="listening-questions">
    <!-- pertanyaan sama seperti sebelumnya -->
  </ol>
  <button onclick="checkAnswers()" class="btn-check">Cek Jawaban</button>
  <p id="result"></p>
</div>
`,
        },
        week2: {
          title: 'Week 2 â€“ Coming Soon',
          content: `<div class='module-box'><h3>Coming Soon</h3><p>Minggu ini masih dikunci. Fokus dulu Week 1: Speaking & Conversation Basics.</p></div>`,
        },
        week3: {
          title: 'Week 3 â€“ Coming Soon',
          content: `<div class='module-box'><h3>Coming Soon</h3><p>Minggu ini akan terbuka setelah Week 2 selesai.</p></div>`,
        },
        week4: {
          title: 'Week 4 â€“ Coming Soon',
          content: `<div class='module-box'><h3>Coming Soon</h3><p>Minggu terakhir akan aktif setelah semua minggu sebelumnya selesai.</p></div>`,
        },
      };

      function loadModule(week) {
        document.getElementById('module-title').innerHTML = modules[week].title;
        document.getElementById('module-content').innerHTML = modules[week].content;
      }

      function checkAnswers() {
        const correct = {
          q1: 'He',
          q2: 'me',
          q3: 'She',
          q4: 'him',
          q5: 'her',
          q6: 'them',
          q7: 'They',
          q8: 'him',
          q9: 'it',
          q10: 'them',
        };

        let score = 0;
        let wrongList = [];

        document.querySelectorAll('#listening-questions li').forEach((li) => {
          li.style.background = 'transparent';
          li.style.border = 'none';
          li.style.padding = '5px';
          li.style.borderRadius = '5px';
        });

        for (let q in correct) {
          const li = document.querySelector(`input[name="${q}"]`)?.closest('li');
          const selected = document.querySelector(`input[name="${q}"]:checked`);
          if (li) {
            if (selected) {
              if (selected.value === correct[q]) {
                score++;
                li.style.background = '#d4ffd4';
                li.style.border = '1px solid #3cb43c';
              } else {
                wrongList.push(q);
                li.style.background = '#ffd4d4';
                li.style.border = '1px solid #d43c3c';
              }
            } else {
              wrongList.push(q);
              li.style.background = '#ffd4d4';
              li.style.border = '1px solid #d43c3c';
            }
          }
        }

        let wrongText = '';
        if (wrongList.length > 0) {
          wrongText = '<br><b>Soal yang salah:</b> ' + wrongList.join(', ');
        }

        document.getElementById('result').innerHTML = `<b>Nilai Kamu:</b> ${score} / 10 ${wrongText}`;
      }

      // ----------------------
      // Export ke global untuk onclick HTML
      // ----------------------
      window.loadModule = loadModule;
      window.checkAnswers = checkAnswers;
    </script>
  </body>
</html>
